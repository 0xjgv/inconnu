
{
  "status": "ok",
  "issue": {
    "id": "ede26091-c437-4008-90a6-e9683f6a4b9f",
    "scan_id": "c9a5b7a3-4470-427b-9b1f-b1149b72f3f0",
    "status": "open",
    "urgency": "LO",
    "created_at": "2025-07-11T15:07:25.337Z",
    "classification": {
      "id": "CWE-625",
      "name": "Permissive Regular Expression",
      "description": "The product uses a regular expression that does not sufficiently restrict the set of allowed values."
    },
    "location": {
      "file": {
        "name": "patterns.py",
        "language": "python",
        "path": "inconnu/nlp/patterns.py"
      },
      "line_number": 57,
      "project": {
        "name": "build",
        "branch": "main",
        "git_sha": "7257bc0f80f9b5656bf6d1309fcd2454affc733d"
      }
    },
    "details": {
      "explanation": "The regular expression <code>UNICODE_BULLETS_RE_0W</code> allows more values than intended, risking unexpected matches that could cause bugs or security issues.<br><br>• The regex uses lookahead \"(?=...)\" and negative lookbehind \"(?<!...)\" but may not fully restrict matched patterns.<br><br>• Unexpected input matching \"BULLETS_PATTERN\" could bypass validation or trigger wrong behavior.<br><br>• Malicious input exploiting this can cause logic errors or data issues when handling important text processing."
    },
    "auto_triage": {
      "false_positive_detection": {
        "status": "valid",
        "reasoning": "The construction of <code>BULLETS_PATTERN</code> uses raw bullet characters joined with \"|\" without escaping regex metacharacters such as <code>\"\\*\"</code> and <code>\"\\-\"</code>. This leads to potential unintended regex behavior when <code>BULLETS_PATTERN</code> is embedded directly into regex patterns on lines 55, 57, and 79, which can affect matching and potentially introduce subtle security issues like regex injection if the bullet list is modified. Since the bullets include special characters and are interpolated directly, this is a valid vulnerability."
      }
    },
    "auto_fix_suggestion": {
      "id": "a9fdc97e-a522-4a2a-89a3-d80d24d707fa",
      "status": "on_hold",
      "patch": {
        "diff": "diff --git a/inconnu/nlp/patterns.py b/inconnu/nlp/patterns.py\nindex ed4774b..dc74e77 100644\n--- a/inconnu/nlp/patterns.py\n+++ b/inconnu/nlp/patterns.py\n@@ -51,6 +51,7 @@ UNICODE_BULLETS: Final[List[str]] = [\n     \"\\x95\",\n     \"·\",\n ]\n+BULLETS_PATTERN = \"|\".join([re.escape(bullet) for bullet in UNICODE_BULLETS])\n BULLETS_PATTERN = \"|\".join(UNICODE_BULLETS)\n UNICODE_BULLETS_RE = re.compile(f\"(?:{BULLETS_PATTERN})(?!{BULLETS_PATTERN})\")\n # zero-width positive lookahead so bullet characters will not be removed when using .split()\n",
        "explanation": ""
      },
      "full_code": null
    }
  }
}
